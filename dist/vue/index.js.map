{"version":3,"file":"index.js","sources":["../../src/code/utils/env.js","../../src/code/utils/index.js","../../src/code/observer/dep.js","../../src/code/observer/array.js","../../src/code/observer/index.js","../../src/code/instance/state.js","../../src/compiler/astParser.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/code/observer/scheduler.js","../../src/code/observer/Watcher.js","../../src/shared/util.js","../../src/code/vdom/patchTypes.js","../../src/code/vdom/diff.js","../../src/code/vdom/patch.js","../../src/code/instance/lifecycle.js","../../src/code/init.js","../../src/code/vdom/vnode.js","../../src/code/vdom/index.js","../../src/index.js"],"sourcesContent":["// can we use __proto__?\nexport const hasProto = '__proto__' in {}\n\n// Browser environment sniffing\nexport const inBrowser = typeof window !== 'undefined'\nexport const UA = inBrowser && window.navigator.userAgent.toLowerCase()\nexport const isIE = UA && /msie|trident/.test(UA)\nexport const isIE9 = UA && UA.indexOf('msie 9.0') > 0\nexport const isEdge = UA && UA.indexOf('edge/') > 0\nexport const isAndroid = UA && UA.indexOf('android') > 0\nexport const isIOS = UA && /iphone|ipad|ipod|ios/.test(UA)\nexport const isChrome = UA && /chrome\\/\\d+/.test(UA) && !isEdge\n\nexport const nextTick = function (watcher) {\n  const nextTickHandler = watcher.run.bind(watcher);\n  let timerFunc;\n  // 这里兼容集中异步 Api 处理\n  if (typeof setImmediate !== 'undefined') {\n    timerFunc = () => {\n      setImmediate(nextTickHandler);\n    };\n  } else if (typeof MessageChannel !== 'undefined') {\n    const channel = new MessageChannel();\n    const port = channel.port2;\n    channel.port1.onmessage = nextTickHandler;\n    timerFunc = () => {\n      port.postMessage(1)\n    }\n  } else\n    if (typeof Promise !== 'undefined') {\n      const p = Promise.resolve();\n      timerFunc = () => {\n        p.then(nextTickHandler);\n      }\n    } else {\n      timerFunc = () => {\n        setTimeout(nextTickHandler, 0);\n      }\n    }\n  // 开启异步更新\n  timerFunc();\n}","function proxy(vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[target][key];\n    },\n    set(newValue) {\n      if (newValue === vm[target][key]) return;\n      vm[target][key] = newValue;\n    }\n  })\n}\n\nfunction isObject(value) {\n  return typeof value === 'object' && value !== null;\n}\n\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n\nfunction def(data, key, value, enumerable) {\n  Object.defineProperty(data, key, {\n    configurable: true,\n    enumerable: !!enumerable,\n    writable: true,\n    value\n  })\n}\n\nfunction remove(arr, item) {\n  if (arr.length) {\n    var index = arr.indexOf(item);\n    if (index > -1) {\n      return arr.splice(index, 1)\n    }\n  }\n}\n\nconst bailRE = /[^\\w.$]/\nfunction parsePath(path) {\n  if (bailRE.test(path)) {\n    return\n  }\n  const segments = path.split('.')\n  return function (obj) {\n    for (let i = 0; i < segments.length; i++) {\n      if (!obj) return\n      obj = obj[segments[i]]\n    }\n    return obj\n  }\n}\n\nexport * from './env';\n\nexport {\n  proxy,\n  isObject,\n  isArray,\n  def,\n  remove,\n  parsePath\n};","import { remove } from '../utils';\n\nlet uid = 0;\n\nexport default class Dep {\n  constructor() {\n    this.id = uid++;\n    this.subs = [];\n  }\n\n  addSub(sub) {\n    this.subs.push(sub);\n  }\n\n  removeSub(sub) {\n    remove(this.subs, sub);\n  }\n\n  depend() {\n    // 给当前 Watcher push 依赖，为了后续和 dep 的 subs 进行比较，移除掉无用的依赖，\n    // 意思就是没用到的属性，在属性变更后就不要通知相对应的 Watcher 了\n    if (Dep.target) {\n      Dep.target.addDep(this); // Watcher 对象中的 addDep，里面会调用 dep.addSub()\n    }\n  }\n\n  notify() {\n    // stabilize the subscriber list first\n    const subs = this.subs.slice(); // 浅拷贝\n    for (let i = 0, l = subs.length; i < l; i++) {\n      subs[i].update(); // 触发依赖更新函数\n    }\n  }\n}\n\nDep.target = null;\nconst targetStack = [];\n\nexport function pushTarget(_target) {\n  if (Dep.target) targetStack.push(Dep.target);\n  Dep.target = _target;\n}\n\nexport function popTarget() {\n  Dep.target = targetStack.pop();\n}","const originArrMethods = Array.prototype,\n  arrayMethods = Object.create(originArrMethods); // 创建一个对象， 并继承 Array.prototype\n\nconst ARR_METHODS = [\n  'push',\n  'pop',\n  'shift',\n  'unshify',\n  'reverse',\n  'sort',\n  'splice',\n];\n\nARR_METHODS.forEach(function (method) {\n  arrayMethods[method] = function (...args) {\n    const result = originArrMethods[method].apply(this, args),\n      ob = this.__ob__;\n\n\n    let newArr;\n\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        newArr = args;\n        break;\n      case 'splice':\n        newArr = args[2];\n        break;\n      default: break;\n    }\n\n    // 对数组新加入的元素进行数据劫持\n    if (newArr) ob.observeArray(newArr);\n    // 返回原函数执行结果\n    return result;\n  }\n})\n\nexport {\n  arrayMethods\n}","import Dep from './dep';\nimport { arrayMethods } from './array';\nimport { isArray, isObject, def, hasProto } from \"../utils\";\n\nconst arrayKeys = Object.getOwnPropertyNames(arrayMethods);\n\nclass Observer {\n  constructor(data) {\n    def(data, '__ob__', this);\n\n    if (isArray(data)) {\n      const augment = hasProto\n        ? protoAugment\n        : copyAugment\n      augment(data, arrayMethods, arrayKeys)\n      this.observeArray(data);\n    } else {\n      this.walk(data);\n    }\n  }\n\n  walk(data) {\n    const keys = Object.keys(data);\n    keys.forEach(function (key) {\n      defineReactive(data, key, data[key]);\n    });\n  }\n\n  observeArray(data) {\n    data.forEach(function (item) {\n      observe(item);\n    });\n  }\n}\n\nfunction protoAugment(target, src, keys) {\n  target.__proto__ = src\n}\n\nfunction copyAugment(target, src, keys) {\n  for (let i = 0, l = keys.length; i < l; i++) {\n    const key = keys[i]\n    def(target, key, src[key])\n  }\n}\n\nfunction defineReactive(data, key, val) {\n  const dep = new Dep(); // 闭包一个依赖对象\n\n  // 查找属性的描述器\n  const property = Object.getOwnPropertyDescriptor(data, key)\n  if (property && property.configurable === false) {\n    return\n  }\n\n  // 判断是否属性本身设置过存储器描述\n  const getter = property && property.get\n  const setter = property && property.set\n\n  observe(val); // 对值内部的属性进行数据劫持，这里源码中会做一个 shallow 判断，是否一开始深层进行依赖\n\n  Object.defineProperty(data, key, {\n    enumerable: true,\n    configurable: true,\n    get() {\n      const value = getter ? getter.call(data) : val;\n      if (Dep.target) {\n        dep.depend(); // 收集依赖,包括 Watcher 收集 dep 和 dep 收集 Watcher\n      }\n      // console.log('响应式获取：' + value);\n      return value;\n    },\n    set(newVal) {\n      const value = getter ? getter.call(newVal) : val;\n      // 这里的 newVal !== newVal && value !== value 为了避免 newVal 和 value 是一个 NaN，很严谨\n      if (newVal === value || (newVal !== newVal && value !== value)) {\n        return\n      }\n      console.log('响应式设置：' + key + ' = ' + newVal);\n      if (setter) {\n        setter.call(data, newVal)\n      } else {\n        val = newVal\n      }\n      observe(newVal); // 对值内部的属性进行数据劫持，这里源码中会做一个 shallow 判断，是否一开始深层进行依赖\n      dep.notify(); // 触发依赖更新函数\n    }\n  })\n}\n\nfunction observe(data) {\n  if (!isObject(data) || data.__ob__) {\n    return data\n  }\n  new Observer(data);\n}\n\nexport {\n  observe\n}","import { observe } from \"../observer\";\nimport { proxy } from '../utils';\n\nfunction initState(vm) {\n  vm._watchers = [];\n  const options = vm.$options;\n\n  if (options.props) {\n    initProps(vm);\n  }\n\n  if (options.methods) {\n    initMethods(vm);\n  }\n\n  if (options.data) {\n    initData(vm);\n  }\n\n  if (options.computed) {\n    initComputed(vm);\n  }\n\n  if (options.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initProps(vm) {\n\n}\n\nfunction initMethods(vm) { }\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data;\n\n  for (let key in data) {\n    proxy(vm, '_data', key);\n  }\n\n  observe(data);\n}\n\nfunction initComputed(vm) { }\n\nfunction initWatch(vm) {\n\n}\n\nexport {\n  initState\n}","// id=\"app\" id='app' id=app\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\n//标签名  <my-header></my-header>\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\n// <my:header></my:header>\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\n// <div\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);\n// > />\nconst startTagClose = /^\\s*(\\/?)>/;\n// </div>\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);\n\n// 以上正则是从官方 Vue 源码扣的\n\nfunction parseHtmlToAst(html) {\n  let text,\n    root,\n    currentParent,\n    stack = [];\n\n  while (html) {\n    // 查找 < 它包括例如： <div> </div>\n    let textEnd = html.indexOf('<');\n\n    if (textEnd === 0) {\n      // 获取到标签组装好的结构对象\n      const startTagMatch = parseStartTag();\n\n      // 对改标签进行子父层级处理\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs);\n        continue;\n      }\n\n      // 获取标签结束 </div> 进行配置\n      const endTagMatch = html.match(endTag);\n\n      if (endTagMatch) {\n        // 删除结束标签的字符\n        advance(endTagMatch[0].length);\n        // 遇到结束标签，进行父子管理处理\n        end();\n        continue;\n      }\n    }\n\n    if (textEnd > 0) {\n      text = html.substring(0, textEnd);\n    }\n\n    if (text) {\n      advance(text.length);\n      chars(text);\n    }\n  }\n\n  function parseStartTag() {\n    const start = html.match(startTagOpen);\n\n    let end, attr;\n\n    if (start) {\n      // 保存标签名\n      const match = {\n        tagName: start[1],\n        attrs: [],\n      };\n      // 删除匹配项\n      advance(start[0].length);\n\n      // 开始匹配标签属性\n      while (!(end = html.match(startTagClose)) && (attr = html.match(dynamicArgAttribute) || html.match(attribute))) {\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5]\n        });\n        advance(attr[0].length);\n      }\n\n      if (end) {\n        // 删除匹配项\n        advance(end[0].length);\n        return match;\n      }\n    }\n  }\n\n  // 对 html 删除匹配项长度父子\n  function advance(len) {\n    html = html.substring(len);\n  };\n\n  // 对开始标签进行父子关系处理\n  function start(tagName, attrs) {\n    const element = createASTElement(tagName, attrs);\n\n    if (!root) {\n      root = element;\n    }\n\n    stack.push(element);\n    currentParent = element;\n  }\n\n  // 对结束标签进行父子关系处理\n  function end() {\n    // 出栈，出栈的就是当前匹配到的结束标签\n    const element = stack.pop();\n\n    // 判断是否有父级\n    if (stack.length > 0) {\n      // 取出父级\n      currentParent = stack[stack.length - 1];\n      // 处理父子关系\n      element.parent = currentParent;\n      currentParent.children.push(element);\n    }\n  }\n\n  function chars(text) {\n    text = text.trim();\n\n    if (text.length > 0) {\n      currentParent.children.push({\n        type: 3,\n        text\n      });\n    }\n  }\n\n  // 组装 AST 标签对象结构\n  function createASTElement(tagName, attrs) {\n    return {\n      tag: tagName,\n      type: 1,\n      children: [],\n      attrs,\n      parent: Window\n    }\n  }\n\n  return root;\n}\n\nexport {\n  parseHtmlToAst\n}","// 判断是否为 {{  }} 这种文本\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\nconst dynamicAttrRE = /^:.+$/;\n\n// 源码的方法名为：genProps，位置：vue/src/compiler/codegen/index.js\nfunction formatProps(attrs) {\n  let attrStr = '';\n  let dynamicAttrStr = '';\n  let dynamic = false;\n\n  attrs.forEach(item => {\n    dynamic = dynamicAttrRE.test(item.name);\n    if (item.name === 'style') {\n      let styleAttrs = {};\n      item.value.split(';').forEach((subItem) => {\n        const [key, value] = subItem.split(':');\n        styleAttrs[key] = value;\n      })\n      item.value = styleAttrs;\n    }\n    if (dynamic) {\n      dynamicAttrStr += `\"${item.name.slice(1)}\", ${item.value},`;\n    } else {\n      attrStr += `${item.name}: ${JSON.stringify(item.value)},`;\n    }\n  })\n\n  attrStr = `{${attrStr.slice(0, -1)}}`\n\n  if (dynamicAttrStr) {\n    return `_d(${attrStr}, [${dynamicAttrStr.slice(0, -1)}])`;\n  } else {\n    return attrStr;\n  }\n}\n\nfunction generateChild(node) {\n  if (node.type === 1) {\n    return generate(node);\n  } else if (node.type === 3) {\n    let text = node.text;\n\n    if (!defaultTagRE.test(text)) {\n      // 这里需要 JSON.stringify 在包一下，否者会出现 _v(hello) 解析的时候 hello 不就成了变量了\n      return `_v(${JSON.stringify(text)})`\n    }\n\n    let match,\n      index, // 保存正则成功解析项的开始索引\n      // defaultTagRE.lastIndex 会在正则解析的时候，一直处于匹配项末端的索引，下一轮匹配就从 defaultTagRE.lastIndex 开始\n      lastIndex = defaultTagRE.lastIndex = 0,\n      textArr = [];\n\n    while (match = defaultTagRE.exec(text)) {\n      index = match.index; // 保存正则成功解析项的开始索引\n      if (index > lastIndex) {\n        textArr.push(JSON.stringify(text.slice(lastIndex, index)));\n      }\n      // 这里不需要 JSON.stringify 原因是，match[1] 指的就是 data 的属性\n      textArr.push(`_s(${match[1].trim()})`);\n      lastIndex = index + match[0].length;\n    }\n\n    // 正则匹配不到了，但是还剩下静态文本\n    if (lastIndex < text.length) {\n      textArr.push(JSON.stringify(text.slice(lastIndex)));\n    }\n\n    // _v('我的姓名是：'+{{name}}+'，请多多关照~')\n    return `_v(${textArr.join('+')})`;\n  }\n}\n\nfunction getChildren(el) {\n  const children = el.children;\n\n  if (children) {\n    return children.map(c => generateChild(c)).join(',');\n  }\n}\n\nfunction generate(el) {\n  const children = getChildren(el);\n\n  const code = `_c(${JSON.stringify(el.tag)}, ${el.attrs.length > 0 ?\n    formatProps(el.attrs) : 'undefined'\n    }${children ?\n      `, ${children}` : ''\n    })`;\n\n  return code;\n};\n\nexport {\n  generate,\n}\n\n","\nimport { parseHtmlToAst } from './astParser';\nimport { generate } from './generate';\n\nfunction compileToRenderFunction(html) {\n  const ast = parseHtmlToAst(html),\n    code = generate(ast),\n    render = new Function(`\n    with(this){ return ${code}; }\n  `);\n  console.log(ast);\n  console.log(code);\n  return render;\n}\n\nexport {\n  compileToRenderFunction\n}","import { nextTick } from '../utils';\n\nfunction queueWatcher(watcher) {\n  nextTick(watcher);\n};\n\nexport {\n  queueWatcher\n}","import { parsePath } from '../utils';\nimport { pushTarget, popTarget } from './dep';\nimport { queueWatcher } from './scheduler';\n\nlet uid = 0;\n\nexport default class Watcher {\n  constructor(vm, expOrFn, options) {\n    this.vm = vm;\n    vm._watchers.push(this);\n\n    // options 源码中还有更多，比如：deep\n    if (options) {\n      this.lazy = !!options.lazy;\n    } else {\n      this.lazy = false;\n    }\n\n    this.id = ++uid;\n    this.deps = []; // 存储和当前 watcher 相关的响应式属性的 dep\n    this.newDeps = []; // 新的 deps\n    this.depIds = new Set();\n    this.newDepIds = new Set();\n\n    if (typeof expOrFn === 'function') {\n      this.getter = expOrFn;\n    } else {\n      // parsePath 解析属性(a.b.c)对应在 vm 的 value，源码存在但本处不涉及到\n      this.getter = parsePath(expOrFn);\n      if (!this.getter) {\n        this.getter = function () { }\n        process.env.NODE_ENV !== 'production' && console.warn(\n          `Failed watching path: \"${expOrFn}\" ` +\n          'Watcher only accepts simple dot-delimited paths. ' +\n          'For full control, use a function instead.'\n        )\n      }\n    }\n\n    // 初次执行\n    this.value = this.lazy\n      ? undefined\n      : this.get();\n  }\n\n  get() {\n    // 这就是让 Dep.target 保存当前的 Watcher\n    pushTarget(this);\n    try {\n      this.getter(); // 执行更新函数\n    } catch (e) {\n      throw e;\n    } finally {\n      popTarget(); // 弹出 Dep.Target\n      this.cleanupDeps(); // 做 Watcher 的 dep 清除\n    }\n  }\n\n  addDep(dep) {\n    const id = dep.id;\n    // 当前 Watcher 的新 depIds 不存在，这加入传进来的 dep\n    if (!this.newDepIds.has(id)) {\n      this.newDepIds.add(id);\n      this.newDeps.push(dep); // Watcher 关联的 dep 保存\n      // Watcher 关联的 dep 没有保存过，让 dep 收集当前的 Watcher 依赖\n      // Watcher 已保存过了 dep 那就说明，当前 dep 也已经收集了当前 Watcher 了，所有就不需要让 dep 收集依赖了\n      if (!this.depIds.has(id)) {\n        dep.addSub(this);\n      }\n    }\n  }\n\n  /**\n   * Clean up for dependency collection.\n   */\n  cleanupDeps() {\n    // 源码有更多\n    this.depIds = this.newDepIds;\n    this.newDepIds.clear(); // 清除最新记录 depIds 集合\n    this.deps = this.newDeps;\n    this.newDeps.length = 0; // 清除最新记录 dep 集合\n  }\n\n  update() {\n    // 这里的话，源码中会有更多的判断\n    // 一般来说更新的话，会进行异步更新，会涉及到 nextTick 函数\n    // 最终会执行 run() 函数\n    queueWatcher(this);\n  }\n\n  run() {\n    this.get();\n  }\n}","export function isUndef(v) {\n  return v === undefined || v === null\n}\n\nexport function isDef(v) {\n  return v !== undefined && v !== null\n}","export const ATTR = 'ATTR';\nexport const TEXT = 'TEXT';\nexport const REPLACE = 'REPLACE';\nexport const REMOVE = '';","import { ATTR, TEXT, REMOVE, REPLACE } from './patchTypes';\n\n// 存储 diff 产生的补丁\nlet patches = {};\nlet vnIndex = 0;\n\nfunction diff(oldVnode, vnode) {\n  const index = 0; // 初始从零开始\n  patches = {};\n  vNodeWalk(oldVnode, vnode, index);\n  return patches;\n}\n\nfunction vNodeWalk(oldVnode, vnode, index) {\n  const vnPatch = [];\n\n  if (!vnode) {\n    // 新 vnode 被删除了\n    vnPatch.push({\n      type: REMOVE,\n      index\n    });\n  } else if (oldVnode.text && vnode.text) {\n    if (oldVnode.text !== vnode.text) {\n      vnPatch.push({\n        type: TEXT,\n        text: vnode.text\n      });\n    }\n  } else if (oldVnode.tag === vnode.tag) {\n    const attrsPatch = attrsWalk(oldVnode.props, vnode.props);\n    if (Object.keys(attrsPatch).length) {\n      vnPatch.push({\n        type: ATTR,\n        attrs: attrsPatch\n      });\n    }\n    childrenWalk(oldVnode.children, vnode.children);\n  } else {\n    vnPatch.push({\n      type: REPLACE,\n      vnode\n    });\n  }\n\n  if (vnPatch.length) {\n    patches[index] = vnPatch;\n  }\n}\n\nfunction attrsWalk(oldProps, newProps) {\n  const attrsPatch = {};\n\n  for (const key in oldProps) {\n    if (JSON.stringify(oldProps[key]) !== JSON.stringify(newProps[key])) {\n      // 旧有，新没，会压入 undefined\n      // 旧有，新有，替换\n      attrsPatch[key] = newProps[key];\n    }\n  }\n\n  for (const key in newProps) {\n    if (!oldProps.hasOwnProperty(key)) {\n      // 旧没，新有，新增\n      attrsPatch[key] = newProps[key];\n    }\n  }\n  return attrsPatch;\n}\n\nfunction childrenWalk(oldChildren, newChildren) {\n  oldChildren.map((child, idx) => {\n    vNodeWalk(child, newChildren[idx], ++vnIndex);\n  })\n}\n\nexport {\n  diff\n};","\nimport { isUndef, isDef } from '../../shared/util.js';\nimport { diff } from './diff.js';\n\nfunction patch(oldVnode, vnode) {\n  // 判断新的 vnode 不存在\n  if (isUndef(vnode)) {\n    // 判断旧节点存在\n    if (isDef(oldVnode)) {\n      // Vue 源码这里会执行销毁的生命周期函数，直接删除旧节点内容\n      removeElement(oldVnode);\n    }\n    return;\n  }\n\n  // 判断 oldVnode 是否是真实节点\n  const isRealElement = isDef(oldVnode.nodeType),\n    el = isRealElement ? oldVnode : oldVnode.el;\n\n  if (isRealElement) {\n    // 首次挂载\n    const nEl = createElement(vnode),\n      parentElement = el.parentElement;\n\n    // el.nextSibling 指的是 el 的兄弟节点\n    parentElement.insertBefore(nEl, el.nextSibling);\n    parentElement.removeChild(el);\n    return nEl;\n  } else {\n    // oldVnode 与 vnode diff 比较打补丁\n    const patches = diff(oldVnode, vnode);\n    console.log(patches);\n    if (Object.keys(patches).length) {\n      // 开始打补丁\n    }\n    return el;\n  }\n}\n\nfunction createElement(vnode) {\n  const { tag, props, children, text } = vnode;\n  if (typeof tag === 'string') {\n    vnode.el = document.createElement(tag);\n    updateProps(vnode);\n    children.forEach(function (child) {\n      vnode.el.appendChild(createElement(child));\n    })\n  } else {\n    vnode.el = document.createTextNode(text);\n  }\n  return vnode.el;\n}\n\nfunction updateProps(vnode) {\n  const el = vnode.el,\n    newProps = vnode.props || {};\n\n  for (let key in newProps) {\n    if (Object.hasOwnProperty.call(newProps, key)) {\n      if (key === 'style') {\n        for (let sKey in newProps[key]) {\n          if (Object.hasOwnProperty.call(newProps[key], sKey)) {\n            el.style[sKey] = newProps[key][sKey];\n          }\n        }\n      } else if (key === 'class') {\n        el.className = el.class;\n      } else {\n        el.setAttribute(key, newProps[key]);\n      }\n    }\n  }\n}\n\nfunction removeElement(oldVnode) {\n  // 判断 oldVnode 是否是真实节点\n  const isRealElement = isDef(oldVnode.nodeType)\n  let el = isRealElement ? oldVnode : oldVnode.el;\n  const childNodes = el.childNodes;\n  for (const item of childNodes) {\n    removeNode(el, childNode);\n  }\n}\n\nfunction removeNode(parent, childNode) {\n  parent.removeChild(childNode);\n}\n\nexport {\n  patch\n};","\nimport Watcher from '../observer/Watcher';\nimport { patch } from '../vdom/patch';\n\nfunction mountComponent(vm, el) {\n  vm.$el = el;\n  // 做一些环境判断\n  if (!vm.$options.render) {\n    if (process.env.NODE_ENV !== 'production') {\n      if ((vm.$options.template && vm.$options.template.charAt(0) !== '#') ||\n        vm.$options.el || el) {\n        console.warn(\n          'You are using the runtime-only build of Vue where the template ' +\n          'compiler is not available. Either pre-compile the templates into ' +\n          'render functions, or use the compiler-included build.'\n        )\n      } else {\n        console.warn(\n          'Failed to mount component: template or render function not defined.'\n        )\n      }\n    }\n  }\n\n  // 这个方法在源码中声明时会根据 process.env.NODE_ENV !== 'production' 做一些额外处理\n  const updateComponent = () => {\n    vm._update(vm._render())\n  }\n\n  // 创建一个 render Watcher，这里会执行 updateComponent 对响应式数据做依赖搜集\n  vm._watcher = new Watcher(vm, updateComponent);\n\n}\n\nfunction lifecycleMixin(Vue) {\n  Vue.prototype._update = function (vnode) {\n    const vm = this,\n      prevVnode = vm._vnode;\n\n    // 保存当前 vnode\n    vm._vnode = vnode;\n\n    if (!prevVnode) {\n      vm.$el = patch(vm.$el, vnode);\n    } else {\n      vm.$el = patch(prevVnode, vnode);\n    }\n  }\n}\n\nexport {\n  lifecycleMixin,\n  mountComponent\n}","import { initState } from './instance/state';\nimport { compileToRenderFunction } from '../compiler';\nimport { mountComponent } from './instance/lifecycle';\n\nfunction initMixin(Vue) {\n    // 世界的开始\n    Vue.prototype._init = function (options) {\n        const vm = this;\n\n        vm.$options = options;\n\n        // 响应式劫持\n        initState(vm);\n\n        if (vm.$options.el) {\n            // 挂载函数 Vue.prototype.$mount\n            vm.$mount(vm.$options.el)\n        }\n    }\n\n    Vue.prototype.$mount = function (el) {\n        const vm = this,\n            options = vm.$options;\n\n        el = document.querySelector(el);\n\n        if (!options.render) {\n            let template = options.template;\n\n            if (!template) {\n                template = el.outerHTML;\n            }\n\n            // 构建 AST -> Render\n            const render = compileToRenderFunction(template);\n            options.render = render;\n        }\n        // console.log(options.render);\n        mountComponent(vm, el);\n    }\n}\n\nexport {\n    initMixin\n};","class VNode {\n  constructor(tag, props, children, text) {\n    this.tag = tag;\n    this.props = props;\n    this.children = children;\n    this.text = text;\n  }\n}\n\nfunction createElement(tag, attrs = {}, ...children) {\n  return new VNode(tag, attrs, children);\n}\n\nfunction createTextVNode(text) {\n  return new VNode(undefined, undefined, undefined, text);\n}\n\nexport {\n  createElement,\n  createTextVNode\n}","import { createElement, createTextVNode } from './vnode';\n\nfunction renderMixin(Vue) {\n\n  Vue.prototype._c = function () {\n    return createElement(...arguments);\n  }\n\n  Vue.prototype._v = function () {\n    return createTextVNode(...arguments);\n  }\n\n  Vue.prototype._s = function (value) {\n    if (!value) return;\n    // 这里为什么直接获取 value 就行，\n    // 因为这个 value 就是执行 render 的时候在通过 with 作用下直接获取到了 vm 代理后拿到 _data 的属性\n    return typeof value === 'object' ? JSON.stringify(value) : value;\n  }\n\n  Vue.prototype._d = function (baseObj, values) {\n    for (let i = 0; i < values.length; i += 2) {\n      const key = values[i];\n      if (typeof key === 'string' && key) {\n        baseObj[values[i]] = values[i + 1];\n      }\n    }\n    return baseObj;\n  }\n\n  Vue.prototype._render = function () {\n    const vm = this,\n      render = vm.$options.render,\n      vnode = render.call(vm); // 执行这个 render 的时候，会调用 _c、_v、_s 函数\n    return vnode;\n  }\n}\n\nexport {\n  renderMixin\n};","import { initMixin } from './code/init';\nimport { lifecycleMixin } from './code/instance/lifecycle';\nimport { renderMixin } from './code/vdom';\n\nfunction Vue(options) {\n    this._init(options);\n}\n\ninitMixin(Vue);\nlifecycleMixin(Vue);\nrenderMixin(Vue);\n\nexport default Vue;\n"],"names":["hasProto","inBrowser","window","UA","navigator","userAgent","toLowerCase","test","indexOf","isEdge","nextTick","watcher","nextTickHandler","run","bind","timerFunc","setImmediate","MessageChannel","channel","port","port2","port1","onmessage","postMessage","Promise","p","resolve","then","setTimeout","proxy","vm","target","key","Object","defineProperty","get","set","newValue","isObject","value","isArray","Array","def","data","enumerable","configurable","writable","remove","arr","item","length","index","splice","bailRE","parsePath","path","segments","split","obj","i","uid","Dep","constructor","id","subs","addSub","sub","push","removeSub","depend","addDep","notify","slice","l","update","targetStack","pushTarget","_target","popTarget","pop","originArrMethods","prototype","arrayMethods","create","ARR_METHODS","forEach","method","args","result","apply","ob","__ob__","newArr","observeArray","arrayKeys","getOwnPropertyNames","Observer","augment","protoAugment","copyAugment","walk","keys","defineReactive","observe","src","__proto__","val","dep","property","getOwnPropertyDescriptor","getter","setter","call","newVal","console","log","initState","_watchers","options","$options","props","methods","initData","computed","watch","_data","attribute","dynamicArgAttribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","parseHtmlToAst","html","text","root","currentParent","stack","textEnd","startTagMatch","parseStartTag","start","tagName","attrs","endTagMatch","match","advance","end","substring","chars","attr","name","len","element","createASTElement","parent","children","trim","type","tag","Window","defaultTagRE","dynamicAttrRE","formatProps","attrStr","dynamicAttrStr","dynamic","styleAttrs","subItem","JSON","stringify","generateChild","node","generate","lastIndex","textArr","exec","join","getChildren","el","map","c","code","compileToRenderFunction","ast","render","Function","queueWatcher","Watcher","expOrFn","lazy","deps","newDeps","depIds","Set","newDepIds","process","env","NODE_ENV","warn","undefined","e","cleanupDeps","has","add","clear","isUndef","v","isDef","ATTR","TEXT","REPLACE","REMOVE","patches","vnIndex","diff","oldVnode","vnode","vNodeWalk","vnPatch","attrsPatch","attrsWalk","childrenWalk","oldProps","newProps","hasOwnProperty","oldChildren","newChildren","child","idx","patch","removeElement","isRealElement","nodeType","nEl","createElement","parentElement","insertBefore","nextSibling","removeChild","document","updateProps","appendChild","createTextNode","sKey","style","className","class","setAttribute","childNodes","removeNode","childNode","mountComponent","$el","template","charAt","updateComponent","_update","_render","_watcher","lifecycleMixin","Vue","prevVnode","_vnode","initMixin","_init","$mount","querySelector","outerHTML","VNode","createTextVNode","renderMixin","_c","arguments","_v","_s","_d","baseObj","values"],"mappings":"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"}