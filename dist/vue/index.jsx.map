{"version":3,"file":"index.jsx","sources":["../../src/code/observer/array.js","../../src/code/utils/index.js","../../src/code/observer/index.js","../../src/code/instance/state.js","../../src/code/init.js","../../src/index.js"],"sourcesContent":["import { observe } from \".\";\n\nconst originArrMethods = Array.prototype,\n  newArrMethods = Object.create(originArrMethods); // 创建一个对象， 并继承 Array.prototype\n\nconst ARR_METHODS = [\n  'push',\n  'pop',\n  'shift',\n  'unshify',\n  'reverse',\n  'sort',\n  'splice',\n];\n\nARR_METHODS.forEach(function (method) {\n  newArrMethods[method] = function (...args) {\n    const result = originArrMethods[method].apply(this, args),\n      ob = this.__ob__;\n\n\n    let newArr;\n\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        newArr = args;\n        break;\n      case 'splice':\n        newArr = args[2];\n        break;\n      default: break;\n    }\n\n    // 对数组新加入的元素进行数据劫持\n    if (newArr) ob.observeArray(newArr);\n    // 返回原函数执行结果\n    return result;\n  }\n})\n\nexport {\n  newArrMethods\n}","function proxy(vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return target[key];\n    },\n    set(newValue) {\n      if (newValue === target[key]) return;\n      target[key] = newValue;\n    }\n  })\n}\n\nfunction isObject(value) {\n  return typeof value === 'object' && value !== null;\n}\n\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n\nfunction setConstantProperty(data, key, value) {\n  Object.defineProperty(data, key, {\n    configurable: false,\n    enumerable: false,\n    writable: true,\n    value\n  })\n}\n\nexport {\n  proxy,\n  isObject,\n  isArray,\n  setConstantProperty,\n}","import { newArrMethods } from './array';\nimport { isArray, isObject, setConstantProperty } from \"../utils\";\n\nclass Observer {\n  constructor(data) {\n    setConstantProperty(data, '__ob__', this);\n\n    if (isArray(data)) {\n      data.__proto__ == newArrMethods;\n      this.observeArray(data);\n    } else {\n      this.walk(data);\n    }\n  }\n\n  walk(data) {\n    const keys = Object.keys(data);\n    keys.forEach(function (key) {\n      defineReactive(data, key, data[key]);\n    });\n  }\n\n  observeArray(data) {\n    data.forEach(function (item) {\n      observe(item);\n    });\n  }\n\n}\n\nfunction defineReactive(data, key, value) {\n  Object.defineProperty(data, key, {\n    get() {\n      console.log('响应式获取：' + value);\n      return value;\n    },\n    set() {\n      console.log('响应式设置：' + key + ' = ' + newValue);\n      observe(newValue); // 对新加入的数据 value 进行数据劫持\n      value = newValue;\n    }\n  })\n}\n\nfunction observe(data) {\n  if (!isObject(data) || data.__ob__) {\n    return data\n  }\n  new Observer(data);\n}\n\nexport {\n  observe\n}","import { observe } from \"../observer\";\nimport { proxy } from '../utils';\n\nfunction initState(vm) {\n  const options = vm.$options;\n\n  if (options.props) {\n    initProps(vm);\n  }\n\n  if (options.methods) {\n    initMethods(vm);\n  }\n\n  if (options.data) {\n    initData(vm);\n  }\n\n  if (options.computed) {\n    initComputed(vm);\n  }\n\n  if (options.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initProps(vm) {\n\n}\n\nfunction initMethods(vm) { }\n\nfunction initData(vm) {\n  let data = vm.$options.data;\n\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data;\n\n  for (let key in data) {\n    proxy(vm, '_data', key);\n  }\n\n  observe(data);\n}\n\nfunction initComputed(vm) { }\n\nfunction initWatch(vm) {\n\n}\n\nexport {\n  initState\n}","import { initState } from './instance/state';\n// import { compileToRenderFunction } from '../compiler';\n// import { mountComponent } from './instance/lifecycle';\n\nfunction initMixin (Vue) {\n    // 世界的开始\n    Vue.prototype._init = function (option) {\n        const vm = this;\n\n        vm.$options = options;\n\n        // 响应式劫持\n        initState(vm);\n\n        // if (vm.$options.el) {\n        //     // 挂载函数 Vue.prototype.$mount\n        //     vm.$mount(vm.$options.el)\n        // }\n    }\n\n    // Vue.prototype.$mount = function(el) {\n    //     const vm = this,\n    //         options = vm.$options;\n\n    //     el = document.querySelector('el'),\n    //     vm.$el = el;\n\n    //     if (!options.render) {\n    //         let template = options.template;\n\n    //         if (!template) {\n    //             template = el.outerHTML;\n    //         }\n\n    //         // 构建 AST -> Render\n    //         const render = compileToRenderFunction(template);\n    //         options.render = render;\n    //     }\n\n    //     mountComponent(vm);\n    // }\n}\n\nexport {\n    initMixin\n};","import { initMixin } from './code/init';\n// import { lifecycleMixin } from './code/instance/lifecycle';\n// import { renderMixin } from './code/vdom';\n\nfunction Vue(options) {\n    this_init(options);\n}\n\ninitMixin(Vue);\n// lifecycleMixin(Vue);\n// renderMixin(Vue);\n\nexport default Vue;\n"],"names":["originArrMethods","Array","prototype","newArrMethods","Object","create","ARR_METHODS","forEach","method","args","result","apply","ob","__ob__","newArr","observeArray","proxy","vm","target","key","defineProperty","get","set","newValue","isObject","value","isArray","setConstantProperty","data","configurable","enumerable","writable","Observer","constructor","__proto__","walk","keys","defineReactive","item","observe","console","log","initState","options","$options","props","methods","initData","computed","watch","_data","call","initMixin","Vue","_init","option","this_init"],"mappings":";;;;;;EAEA,MAAMA,gBAAgB,GAAGC,KAAK,CAACC,SAA/B;EAAA,MACEC,aAAa,GAAGC,MAAM,CAACC,MAAP,CAAcL,gBAAd,CADlB;;EAGA,MAAMM,WAAW,GAAG,CAClB,MADkB,EAElB,KAFkB,EAGlB,OAHkB,EAIlB,SAJkB,EAKlB,SALkB,EAMlB,MANkB,EAOlB,QAPkB,CAApB;EAUAA,WAAW,CAACC,OAAZ,CAAoB,UAAUC,MAAV,EAAkB;EACpCL,EAAAA,aAAa,CAACK,MAAD,CAAb,GAAwB,UAAU,GAAGC,IAAb,EAAmB;EACzC,UAAMC,MAAM,GAAGV,gBAAgB,CAACQ,MAAD,CAAhB,CAAyBG,KAAzB,CAA+B,IAA/B,EAAqCF,IAArC,CAAf;EAAA,UACEG,EAAE,GAAG,KAAKC,MADZ;EAIA,QAAIC,MAAJ;;EAEA,YAAQN,MAAR;EACE,WAAK,MAAL;EACA,WAAK,SAAL;EACEM,QAAAA,MAAM,GAAGL,IAAT;EACA;;EACF,WAAK,QAAL;EACEK,QAAAA,MAAM,GAAGL,IAAI,CAAC,CAAD,CAAb;EACA;EAPJ,KAPyC;;;EAmBzC,QAAIK,MAAJ,EAAYF,EAAE,CAACG,YAAH,CAAgBD,MAAhB,EAnB6B;;EAqBzC,WAAOJ,MAAP;EACD,GAtBD;EAuBD,CAxBD;;ECfA,SAASM,KAAT,CAAeC,EAAf,EAAmBC,MAAnB,EAA2BC,GAA3B,EAAgC;EAC9Bf,EAAAA,MAAM,CAACgB,cAAP,CAAsBH,EAAtB,EAA0BE,GAA1B,EAA+B;EAC7BE,IAAAA,GAAG,GAAG;EACJ,aAAOH,MAAM,CAACC,GAAD,CAAb;EACD,KAH4B;;EAI7BG,IAAAA,GAAG,CAACC,QAAD,EAAW;EACZ,UAAIA,QAAQ,KAAKL,MAAM,CAACC,GAAD,CAAvB,EAA8B;EAC9BD,MAAAA,MAAM,CAACC,GAAD,CAAN,GAAcI,QAAd;EACD;;EAP4B,GAA/B;EASD;;EAED,SAASC,QAAT,CAAkBC,KAAlB,EAAyB;EACvB,SAAO,OAAOA,KAAP,KAAiB,QAAjB,IAA6BA,KAAK,KAAK,IAA9C;EACD;;EAED,SAASC,OAAT,CAAiBD,KAAjB,EAAwB;EACtB,SAAOxB,KAAK,CAACyB,OAAN,CAAcD,KAAd,CAAP;EACD;;EAED,SAASE,mBAAT,CAA6BC,IAA7B,EAAmCT,GAAnC,EAAwCM,KAAxC,EAA+C;EAC7CrB,EAAAA,MAAM,CAACgB,cAAP,CAAsBQ,IAAtB,EAA4BT,GAA5B,EAAiC;EAC/BU,IAAAA,YAAY,EAAE,KADiB;EAE/BC,IAAAA,UAAU,EAAE,KAFmB;EAG/BC,IAAAA,QAAQ,EAAE,IAHqB;EAI/BN,IAAAA;EAJ+B,GAAjC;EAMD;;ECxBD,MAAMO,QAAN,CAAe;EACbC,EAAAA,WAAW,CAACL,IAAD,EAAO;EAChBD,IAAAA,mBAAmB,CAACC,IAAD,EAAO,QAAP,EAAiB,IAAjB,CAAnB;;EAEA,QAAIF,OAAO,CAACE,IAAD,CAAX,EAAmB;EACjBA,MAAAA,IAAI,CAACM,SAAL,IAAkB/B,aAAlB;EACA,WAAKY,YAAL,CAAkBa,IAAlB;EACD,KAHD,MAGO;EACL,WAAKO,IAAL,CAAUP,IAAV;EACD;EACF;;EAEDO,EAAAA,IAAI,CAACP,IAAD,EAAO;EACT,UAAMQ,IAAI,GAAGhC,MAAM,CAACgC,IAAP,CAAYR,IAAZ,CAAb;EACAQ,IAAAA,IAAI,CAAC7B,OAAL,CAAa,UAAUY,GAAV,EAAe;EAC1BkB,MAAAA,cAAc,CAACT,IAAD,EAAOT,GAAP,EAAYS,IAAI,CAACT,GAAD,CAAhB,CAAd;EACD,KAFD;EAGD;;EAEDJ,EAAAA,YAAY,CAACa,IAAD,EAAO;EACjBA,IAAAA,IAAI,CAACrB,OAAL,CAAa,UAAU+B,IAAV,EAAgB;EAC3BC,MAAAA,OAAO,CAACD,IAAD,CAAP;EACD,KAFD;EAGD;;EAvBY;;EA2Bf,SAASD,cAAT,CAAwBT,IAAxB,EAA8BT,GAA9B,EAAmCM,KAAnC,EAA0C;EACxCrB,EAAAA,MAAM,CAACgB,cAAP,CAAsBQ,IAAtB,EAA4BT,GAA5B,EAAiC;EAC/BE,IAAAA,GAAG,GAAG;EACJmB,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAWhB,KAAvB;EACA,aAAOA,KAAP;EACD,KAJ8B;;EAK/BH,IAAAA,GAAG,GAAG;EACJkB,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAWtB,GAAX,GAAiB,KAAjB,GAAyBI,QAArC;EACAgB,MAAAA,OAAO,CAAChB,QAAD,CAAP,CAFI;;EAGJE,MAAAA,KAAK,GAAGF,QAAR;EACD;;EAT8B,GAAjC;EAWD;;EAED,SAASgB,OAAT,CAAiBX,IAAjB,EAAuB;EACrB,MAAI,CAACJ,QAAQ,CAACI,IAAD,CAAT,IAAmBA,IAAI,CAACf,MAA5B,EAAoC;EAClC,WAAOe,IAAP;EACD;;EACD,MAAII,QAAJ,CAAaJ,IAAb;EACD;;EC9CD,SAASc,SAAT,CAAmBzB,EAAnB,EAAuB;EACrB,QAAM0B,OAAO,GAAG1B,EAAE,CAAC2B,QAAnB;;EAEA,MAAID,OAAO,CAACE,KAAZ,EAAmB;;EAInB,MAAIF,OAAO,CAACG,OAAZ,EAAqB;;EAIrB,MAAIH,OAAO,CAACf,IAAZ,EAAkB;EAChBmB,IAAAA,QAAQ,CAAC9B,EAAD,CAAR;EACD;;EAED,MAAI0B,OAAO,CAACK,QAAZ,EAAsB;;EAItB,MAAIL,OAAO,CAACM,KAAZ,EAAmB;EAGpB;;EAQD,SAASF,QAAT,CAAkB9B,EAAlB,EAAsB;EACpB,MAAIW,IAAI,GAAGX,EAAE,CAAC2B,QAAH,CAAYhB,IAAvB;EAEAX,EAAAA,EAAE,CAACiC,KAAH,GAAWtB,IAAI,GAAG,OAAOA,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,CAACuB,IAAL,CAAUlC,EAAV,CAA7B,GAA6CW,IAA/D;;EAEA,OAAK,IAAIT,GAAT,IAAgBS,IAAhB,EAAsB;EACpBZ,IAAAA,KAAK,CAACC,EAAD,EAAK,OAAL,EAAcE,GAAd,CAAL;EACD;;EAEDoB,EAAAA,OAAO,CAACX,IAAD,CAAP;EACD;;ECzCD;;EAEA,SAASwB,SAAT,CAAoBC,GAApB,EAAyB;EACrB;EACAA,EAAAA,GAAG,CAACnD,SAAJ,CAAcoD,KAAd,GAAsB,UAAUC,MAAV,EAAkB;EACpC,UAAMtC,EAAE,GAAG,IAAX;EAEAA,IAAAA,EAAE,CAAC2B,QAAH,GAAcD,OAAd,CAHoC;;EAMpCD,IAAAA,SAAS,CAACzB,EAAD,CAAT,CANoC;EASpC;EACA;EACA;EACH,GAZD,CAFqB;EAiBrB;EACA;EAEA;EACA;EAEA;EACA;EAEA;EACA;EACA;EAEA;EACA;EACA;EACA;EAEA;EACA;;EACH;;ECvCD;;EAEA,SAASoC,GAAT,CAAaV,OAAb,EAAsB;EAClBa,EAAAA,SAAS,CAACb,OAAD,CAAT;EACH;;EAEDS,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}